{"version":3,"sources":["Table.tsx","Form.tsx","diffable/core/variable.ts","diffable/core/expression.ts","diffable/operation.ts","diffable/error.ts","diffable/activation.ts","App.tsx","index.tsx"],"names":["TableHeader","TableBody","props","data","map","row","index","m","b","r","key","isFinite","reverse","Table","Form","state","handleSubmit","handleChange","event","target","name","value","setState","submitForm","samples","sensitivity","generations","this","type","min","onChange","onClick","Component","Variable","val","v","Expression","_value","NaN","_deriv","Map","valueImpl","has","set","derivImpl","get","clear","BinaryProduct","left","right","deriv","print","Sum","terms","reduce","acc","term","join","SquaredError","actual","expect","diff","Softplus","arg","x","y","Math","exp","log","df","App","e","expressions","i","train","Diff","input","length","bind","sumM","sumB","sumR","reset","random","sqrt","push","forEach","expr","output","className","readOnly","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.e17d349f.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nexport type TableRow = {\r\n    m: number;\r\n    b: number;\r\n    r: number;\r\n};\r\n\r\nfunction TableHeader(): JSX.Element {\r\n    return (\r\n        <thead>\r\n            <tr>\r\n                <th>G</th>\r\n                <th>m</th>\r\n                <th>b</th>\r\n                <th>R</th>\r\n            </tr>\r\n        </thead>\r\n    );\r\n}\r\n\r\nfunction TableBody(props: { data: TableRow[] }): JSX.Element {\r\n    return (\r\n        <tbody>{props.data.map((row: TableRow, index: number) => {\r\n            const { m, b, r } = row;\r\n            return (\r\n                <tr key={index}>\r\n                    <td>{index}</td>\r\n                    <td>{isFinite(m) ? m : \"\"}</td>\r\n                    <td>{isFinite(b) ? b : \"\"}</td>\r\n                    <td>{isFinite(r) ? r : \"\"}</td>\r\n                </tr>\r\n            )\r\n        }).reverse()}</tbody>\r\n    );\r\n}\r\n\r\nfunction Table(props: { data: TableRow[] }) {\r\n    const { data } = props;\r\n\r\n    return (\r\n        <table>\r\n            <TableHeader />\r\n            <TableBody data={data} />\r\n        </table>\r\n    );\r\n}\r\n\r\nexport default Table;\r\n","import React, { Component } from 'react';\r\n\r\nexport type FormState = {\r\n    samples: number;\r\n    sensitivity: number;\r\n    generations: number;\r\n};\r\n\r\nexport type FormProps = {\r\n    handleSubmit: (state: FormState) => void;\r\n};\r\n\r\nclass Form extends Component<FormProps> {\r\n    state: FormState;\r\n    handleSubmit: (state: FormState) => void;\r\n\r\n    constructor(props: FormProps) {\r\n        super(props);\r\n\r\n        this.state = { samples: 1, sensitivity: 1, generations: 1 };\r\n        this.handleSubmit = (props as any).handleSubmit;\r\n    }\r\n\r\n    handleChange = (event: { target: { name: any; value: any; }; }) => {\r\n        const { name, value } = event.target;\r\n\r\n        this.setState({ [name]: value });\r\n    }\r\n\r\n    submitForm = () => {\r\n        (this.props as any).handleSubmit(this.state)\r\n    }\r\n\r\n    render() {\r\n        const { samples, sensitivity, generations } = this.state;\r\n\r\n        return (\r\n            <form>\r\n                <label>Samples</label>\r\n                <input\r\n                    type=\"number\"\r\n                    name=\"samples\"\r\n                    value={isFinite(samples) ? samples : \"\"}\r\n                    min=\"1\"\r\n                    onChange={this.handleChange} />\r\n                <br />\r\n                <label>Sensitivity</label>\r\n                <input\r\n                    type=\"number\"\r\n                    name=\"sensitivity\"\r\n                    value={isFinite(sensitivity) ? sensitivity : \"\"}\r\n                    onChange={this.handleChange} />\r\n                <br />\r\n                <label>Generations</label>\r\n                <input\r\n                    type=\"number\"\r\n                    name=\"generations\"\r\n                    value={isFinite(generations) ? generations : \"\"}\r\n                    min=\"0\"\r\n                    onChange={this.handleChange} />\r\n                <br />\r\n                <input type=\"button\" value=\"Train\" onClick={this.submitForm} />\r\n            </form>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Form;\r\n","import Differentiable from './differentiable';\r\n\r\nclass Variable implements Differentiable {\r\n    name: string;\r\n    val: number;\r\n\r\n    constructor(name: string, val: number) {\r\n        this.name = name;\r\n        this.val = val;\r\n    }\r\n\r\n    bind(val: number) { this.val = val; }\r\n\r\n    value(): number { return this.val; }\r\n    deriv(v: Variable): number { return (v === this) ? 1 : 0; }\r\n\r\n    print(): string { return this.name; }\r\n}\r\n\r\nexport default Variable;\r\n","import Differentiable from './differentiable';\r\nimport Variable from './variable';\r\n\r\nabstract class Expression implements Differentiable {\r\n    _value: number = NaN;\r\n    value(): number {\r\n        if (!isFinite(this._value)) {\r\n            this._value = this.valueImpl();\r\n        }\r\n        return this._value;\r\n    }\r\n    protected abstract valueImpl(): number;\r\n\r\n    _deriv = new Map<Variable, number>();\r\n    deriv(v: Variable): number {\r\n        if (!this._deriv.has(v)) {\r\n            this._deriv.set(v, this.derivImpl(v));\r\n        }\r\n        return this._deriv.get(v) as number;\r\n    }\r\n    protected abstract derivImpl(_v: Variable): number;\r\n\r\n    abstract print(): string;\r\n\r\n    reset() {\r\n        this._value = NaN;\r\n        this._deriv.clear();\r\n    }\r\n}\r\n\r\nexport default Expression;\r\n","import Differentiable from './core/differentiable';\r\nimport Expression from './core/expression';\r\nimport Variable from './core/variable';\r\n\r\nclass BinaryProduct extends Expression {\r\n    left: Differentiable;\r\n    right: Differentiable;\r\n\r\n    constructor(left: Differentiable, right: Differentiable) {\r\n        super();\r\n        this.left = left;\r\n        this.right = right;\r\n    }\r\n\r\n    protected valueImpl(): number {\r\n        return this.left.value() * this.right.value();\r\n    }\r\n\r\n    protected derivImpl(v: Variable): number {\r\n        let dlr = this.left.deriv(v) * this.right.value();\r\n        let ldr = this.left.value() * this.right.deriv(v);\r\n        return dlr + ldr;\r\n    }\r\n\r\n    print(): string {\r\n        return this.left.print() + \" * \" + this.right.print();\r\n    }\r\n}\r\n\r\nclass Sum extends Expression {\r\n    terms: Differentiable[];\r\n\r\n    constructor(...terms: Differentiable[]) {\r\n        super();\r\n        this.terms = terms;\r\n    }\r\n\r\n    protected valueImpl(): number {\r\n        return this.terms.reduce((acc, term) => acc + term.value(), 0);\r\n    }\r\n\r\n    protected derivImpl(v: Variable): number {\r\n        return this.terms.reduce((acc, term) => acc + term.deriv(v), 0);\r\n    }\r\n\r\n    print(): string {\r\n        return \"(\" + this.terms.map((term) => term.print()).join(\" + \") + \")\";\r\n    }\r\n}\r\n\r\nexport { BinaryProduct, Sum };\r\n","import Differentiable from './core/differentiable';\r\nimport Expression from './core/expression';\r\nimport Variable from './core/variable';\r\n\r\nclass SquaredError extends Expression {\r\n    actual: Differentiable;\r\n    expect: Differentiable;\r\n\r\n    constructor(actual: Differentiable, expect: Differentiable) {\r\n        super();\r\n        this.actual = actual;\r\n        this.expect = expect;\r\n    }\r\n\r\n    protected valueImpl(): number {\r\n        let diff = this.actual.value() - this.expect.value();\r\n        return diff * diff;\r\n    }\r\n\r\n    protected derivImpl(v: Variable): number {\r\n        let diff = this.actual.value() - this.expect.value();\r\n        return 2 * diff * (this.actual.deriv(v) - this.expect.deriv(v));\r\n    }\r\n\r\n    print(): string {\r\n        return \"(\" + this.actual.print() + \" - \" + this.expect.value() + \")^2\";\r\n    }\r\n}\r\n\r\nexport { SquaredError };\r\n","import Differentiable from './core/differentiable'\r\nimport Expression from './core/expression';\r\nimport Variable from './core/variable';\r\n\r\nclass Logistic extends Expression {\r\n    arg: Differentiable;\r\n\r\n    constructor(arg: Differentiable) {\r\n        super();\r\n        this.arg = arg;\r\n    }\r\n\r\n    protected valueImpl(): number {\r\n        let x = this.arg.value();\r\n        let y = 1 / (1 + Math.exp(-x));\r\n        return isFinite(y) ? y : ((x < 0) ? 0 : 1);\r\n    }\r\n\r\n    protected derivImpl(v: Variable): number {\r\n        let val = this.arg.value();\r\n        let d = this.arg.deriv(v) / (Math.exp(val) + 2 + Math.exp(-val));\r\n        return isFinite(d) ? d : 0;\r\n    }\r\n\r\n    print(): string {\r\n        return \"Ïƒ(\" + this.arg.print() + \")\";\r\n    }\r\n}\r\n\r\nclass Softplus extends Expression {\r\n    arg: Differentiable;\r\n\r\n    constructor(arg: Differentiable) {\r\n        super();\r\n        this.arg = arg;\r\n    }\r\n\r\n    protected valueImpl(): number {\r\n        let x = this.arg.value();\r\n        let y = 1 + Math.exp(x);\r\n        return isFinite(y) ? Math.log(y) : x;\r\n    }\r\n\r\n    protected derivImpl(v: Variable): number {\r\n        let x = this.arg.value();\r\n        let df = 1 / (1 + Math.exp(-x));\r\n        df = isFinite(df) ? df : 0;\r\n        return df * this.arg.deriv(v);\r\n    }\r\n\r\n    print(): string {\r\n        return \"ReLU(\" + this.arg.print() + \")\";\r\n    }\r\n}\r\n\r\nexport { Logistic, Softplus };\r\n","import React, { Component } from 'react';\r\nimport Table, { TableRow } from './Table';\r\nimport Form, { FormState } from './Form';\r\nimport * as Diff from './diffable/diffable';\r\n\r\nclass App extends Component<{}> {\r\n    x: Diff.Variable;\r\n    m: Diff.Variable;\r\n    b: Diff.Variable;\r\n    e: Diff.Variable;\r\n    y: Diff.Softplus;\r\n    r: Diff.SquaredError;\r\n\r\n    expressions: Diff.Expression[];\r\n\r\n    state: { data: TableRow[]; input: number };\r\n\r\n    constructor(props: {}) {\r\n        super(props);\r\n\r\n        this.x = new Diff.Variable('x', 0);\r\n        this.m = new Diff.Variable('m', 1);\r\n        this.b = new Diff.Variable('b', 0);\r\n        this.e = new Diff.Variable(\"expect\", 42);\r\n\r\n        this.expressions = [];\r\n        this.expressions[0] = new Diff.BinaryProduct(this.m, this.x);\r\n        this.expressions[1] = new Diff.Sum(this.expressions[0], this.b);\r\n\r\n        this.y = new Diff.Softplus(this.expressions[1]);\r\n        this.expressions[2] = this.y;\r\n\r\n        this.r = new Diff.SquaredError(this.y, this.e);\r\n        this.expressions[3] = this.r;\r\n\r\n        this.state = { data: [{ m: 1, b: 0, r: NaN }], input: 0 };\r\n    }\r\n\r\n    train(samples: number, sensitivity: number) {\r\n        if (!isFinite(samples)) { return; }\r\n        if (!isFinite(sensitivity)) { return; }\r\n        if (samples <= 0) { return; }\r\n\r\n        let { data } = this.state;\r\n        let { m, b } = data[data.length - 1];\r\n\r\n        this.m.bind(m);\r\n        this.b.bind(b);\r\n\r\n        let sumM: number = 0, sumB: number = 0, sumR: number = 0;\r\n        for (let i = 0; i < samples; ++i) {\r\n            this.reset();\r\n            this.x.bind(Math.random());\r\n\r\n            sumM += this.r.deriv(this.m);\r\n            sumB += this.r.deriv(this.b);\r\n            sumR += this.r.value();\r\n        }\r\n\r\n        m -= sumM * sensitivity / samples;\r\n        b -= sumB * sensitivity / samples;\r\n\r\n        data[data.length - 1].r = Math.sqrt(sumR / samples);\r\n        data.push({ m: m, b: b, r: NaN });\r\n        this.setState({ data: data });\r\n    }\r\n\r\n    reset() {\r\n        this.expressions.forEach((expr) => { expr.reset(); });\r\n    }\r\n\r\n    handleChange = (event: { target: { name: any; value: any }; }) => {\r\n        const { name, value } = event.target;\r\n        this.setState({ [name]: value });\r\n    };\r\n\r\n    handleSubmit = (state: FormState) => {\r\n        for (let i: number = 0; i < state.generations; ++i) {\r\n            this.train(state.samples, state.sensitivity);\r\n        }\r\n    };\r\n\r\n    render() {\r\n        const { data, input } = this.state;\r\n\r\n        let output: number = NaN;\r\n        if (isFinite(input)) {\r\n            const { m, b } = data[data.length - 1];\r\n            this.reset();\r\n            this.m.bind(m);\r\n            this.b.bind(b);\r\n            this.x.bind(input);\r\n            output = this.y.value();\r\n        }\r\n\r\n        return (\r\n            <div className=\"App\">\r\n                <header className=\"App-header\">\r\n                    <h1>Asteria</h1>\r\n                    <p>Asteria wants to learn the answer to life, the universe, and everything, but she needs your help!</p>\r\n                </header>\r\n\r\n                <h2>About</h2>\r\n                <p>Asteria is the simplest possible neural network: a single input neuron linked to a single output neuron.<br />\r\n                She has no hidden layers, so Asteria is really just a linear relation passed through an activation function (softplus).<br />\r\n                The full equation for Asteria is y=ReLU(mx+b). Her initial state is y=ReLU(x), where m=1 and b=0.<br />\r\n                Asteria will be trained to minimize R^2, the mean of (y-42)^2 over randomly-sampled values of x ranging from 0 to 1.</p>\r\n\r\n                <h2>Testing</h2>\r\n                <p>If she has learned well, Asteria should output 42 no matter what input we give her. Test it out here!</p>\r\n                <label>Input</label>\r\n                <input\r\n                    type=\"number\"\r\n                    name=\"input\"\r\n                    value={input}\r\n                    onChange={this.handleChange} />\r\n                <br />\r\n                <label>Output</label>\r\n                <input readOnly\r\n                    type=\"text\"\r\n                    name=\"output\"\r\n                    value={output} />\r\n\r\n                <h2>Training</h2>\r\n                <p>We want Asteria to ultimately settle on y=42~RELU(42), where m=0 and b=42.<br />\r\n                To determine how to adjust m and b, Asteria samples values of x between 0 to 1 (you decide how many) and does fancy backpropogation.<br />\r\n                Sensitivity determines the strength of the adjustments to m and b in each generation of Asteria.<br />\r\n                If sensitivity is negative, Asteria will try to maximize error instead of minimizing it.<br />\r\n                If sensitivity is too large (the upper bound is around 0.75), Asteria will overshoot on her adjustments and fail to settle anywhere.</p>\r\n                <Form handleSubmit={this.handleSubmit} />\r\n                <Table data={data} />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}